<!DOCTYPE html>
<html>
<head>
  <title>Grisigt kladd</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <!-- ... Rest of your HTML content ... -->

  <script>
    var userName = "";
    var socket = new WebSocket('ws://34.88.152.51:8080');  // Adjust the WebSocket URL

    function connectWebSocket() {
      socket.addEventListener('open', (event) => {
        console.log('WebSocket connection established');
      });

      socket.addEventListener('message', (event) => {
        handleReceivedMessage(event.data);
      });

      socket.addEventListener('close', (event) => {
        console.log('WebSocket connection closed');
      });
    }

    function sendMessageToServer(message) {
      if (message.trim() !== "") {
        socket.send(JSON.stringify({ user: userName, message: message }));
      }
    }

    function handleReceivedMessage(message) {
      var chatMessagesElement = document.getElementById("chat-messages");
      var messageElement = document.createElement("div");
      messageElement.innerText = message;
      chatMessagesElement.appendChild(messageElement);
    }

    function handleKeyDown(event) {
      if (event.key === "Enter") {
        event.preventDefault();
        sendMessageToServer(document.getElementById("message-input").value);
        document.getElementById("message-input").value = "";
      }
    }

    function sendMessage() {
      var inputElement = document.getElementById("message-input");
      var message = inputElement.value;
      sendMessageToServer(message);
      inputElement.value = "";

      if (message.trim() !== "") {
        var chatMessagesElement = document.getElementById("chat-messages");
        var messageElement = document.createElement("div");
        messageElement.innerText = userName + ": " + message;
        chatMessagesElement.appendChild(messageElement);
      }
    }

    // Username prompt
    function openPrompt() {
      var modal = document.getElementById("username-modal");
      var storedUsername = sessionStorage.getItem('username');

      if (storedUsername) {
        document.getElementById("username-input").value = storedUsername;
        userName = storedUsername;
        closePrompt();
      } else {
        modal.style.display = "block";
      }
    }

    function closePrompt() {
      var modal = document.getElementById("username-modal");
      modal.style.display = "none";
    }

    function submitUsername() {
      var usernameInput = document.getElementById("username-input");
      var username = usernameInput.value.trim();

      if (username !== "") {
        userName = username;
        sessionStorage.setItem('username', username)
        closePrompt();
      }
    }

    function handleUsernameKeyDown(event) {
      if (event.key === "Enter") {
        event.preventDefault();
        submitUsername();
      }
    }

    openPrompt();
  </script>

  <div id="prompt-modal" class="modal">
    <div class="modal-content">
      <h2>Enter your username:</h2>
      <input type="text" id="username-input">
      <button onclick="submitUsername()">Submit</button>
    </div>
  </div>
</body>
</html>
